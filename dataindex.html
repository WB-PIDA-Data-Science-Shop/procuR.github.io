<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Interactive Excel Viewer</title>

  <!-- DataTables CSS -->
  <link rel="stylesheet" href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css">

  <!-- jQuery + DataTables JS -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>

  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      margin: 20px;
    }
    h1 {
      margin-bottom: 10px;
    }
    #tabs {
      margin-bottom: 15px;
    }
    .tab-button {
      display: inline-block;
      padding: 8px 14px;
      margin-right: 6px;
      margin-bottom: 6px;
      border-radius: 4px;
      border: 1px solid #ccc;
      cursor: pointer;
      background: #f5f5f5;
      font-size: 14px;
    }
    .tab-button.active {
      background: #e0e0ff;
      border-color: #777;
      font-weight: 600;
    }
    .sheet-table {
      display: none;
    }
    .sheet-table.active {
      display: table;
    }
  </style>
</head>
<body>
  <h1>Excel Workbook Viewer</h1>
  <p>Select a sheet below to explore the data (search, sort, paginate).</p>

  <!-- Where sheet buttons will go -->
  <div id="tabs"></div>

  <!-- Where sheet tables will go -->
  <div id="tables"></div>

  <script>
    // Load JSON with all sheets
    fetch('./data.json')
      .then(response => response.json())
      .then(allSheets => {
        const tabsDiv = document.getElementById('tabs');
        const tablesDiv = document.getElementById('tables');

        let firstSheet = true;

        Object.keys(allSheets).forEach(sheetName => {
          const rows = allSheets[sheetName];
          if (!rows || rows.length === 0) return; // skip empty sheets

          // --- Create tab button ---
          const btn = document.createElement('button');
          btn.textContent = sheetName;
          btn.className = 'tab-button';
          btn.dataset.target = 'table_' + sheetName.replace(/\W+/g, '_');
          tabsDiv.appendChild(btn);

          // --- Create table element ---
          const tableId = btn.dataset.target;
          const table = document.createElement('table');
          table.id = tableId;
          table.className = 'display sheet-table';
          table.style.width = '100%';
          tablesDiv.appendChild(table);

          // Build header from keys of first row
          const headers = Object.keys(rows[0]);

          const thead = document.createElement('thead');
          const headerRow = document.createElement('tr');
          headers.forEach(h => {
            const th = document.createElement('th');
            th.textContent = h;
            headerRow.appendChild(th);
          });
          thead.appendChild(headerRow);
          table.appendChild(thead);

          const tbody = document.createElement('tbody');
          rows.forEach(r => {
            const tr = document.createElement('tr');
            headers.forEach(h => {
              const td = document.createElement('td');
              td.textContent = (r[h] !== null && r[h] !== undefined) ? r[h] : '';
              tr.appendChild(td);
            });
            tbody.appendChild(tr);
          });
          table.appendChild(tbody);

          // Initialize DataTables after it's in the DOM
          $(table).DataTable();

          // Make first sheet active by default
          if (firstSheet) {
            btn.classList.add('active');
            table.classList.add('active');
            firstSheet = false;
          }

          // Tab button click handler
          btn.addEventListener('click', () => {
            // Deactivate all
            document.querySelectorAll('.tab-button').forEach(b => b.classList.remove('active'));
            document.querySelectorAll('.sheet-table').forEach(t => t.classList.remove('active'));

            // Activate this one
            btn.classList.add('active');
            table.classList.add('active');
          });
        });
      })
      .catch(err => {
        console.error('Error loading data.json:', err);
        alert('Could not load data.json. Make sure it is in the same folder as index.html.');
      });
  </script>
</body>
</html>